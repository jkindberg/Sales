---
title: "Sales Dashboard"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
---

```{r c8 setup, include=FALSE}
library(flexdashboard)
library(knitr)
library(DT)
library(tidyverse)
```

```{r c7, message=FALSE, warning=FALSE, include=FALSE}
knit("sales_eda.Rmd")
```

Sidebar {.sidebar}
=======================================================================

### This is a sidebar

This is a sidebar that can have buttons or filters

View1
=======================================================================


Column {data-width=600}
-----------------------------------------------------------------------

### Chart A

```{r c6}
library(highcharter)
library(viridisLite)

thm <- 
  hc_theme(
    colors = c("#1a6ecc", "#434348", "#90ed7d"),
    chart = list(
      backgroundColor = "transparent",
      style = list(fontFamily = "Source Sans Pro")
    ),
    xAxis = list(
      gridLineWidth = 1
    )
  )

data("USArrests", package = "datasets")
data("usgeojson")

USArrests <- USArrests %>%
  mutate(state = rownames(.))

n <- 4
colstops <- data.frame(
  q = 0:n/n,
  c = substring(viridis(n + 1), 0, 7)) %>%
  list.parse2()

highchart() %>%
  hc_add_series_map(usgeojson, USArrests, name = "Sales",
                    value = "Murder", joinBy = c("woename", "state"),
                    dataLabels = list(enabled = TRUE,
                                      format = '{point.properties.postalcode}')) %>%
  hc_colorAxis(stops = colstops) %>%
  hc_legend(valueDecimals = 0, valueSuffix = "%") %>%
  hc_mapNavigation(enabled = TRUE) %>%
  hc_add_theme(thm)
```

### Chart B

```{r c9}
library(plotly)
ggplotly(week_sales)
```


Column {.tabset data-width=400}
-----------------------------------------------------------------------

### Chart C

```{r c2}

ggplotly(web_series)
```


### Chart D

```{r c3}
datatable(website)
```



View2
=======================================================================

### Chart E
```{r c4}
website %>% 
  filter(Date != "2017-01-31") %>%
  hchart("scatter", hcaes(x=Users, `Total Web Sales`))
```

### Chart 

```{r c5}
products <- sales %>%
            group_by(product_level, three_four) %>%
            summarize(count = n())

categories_grouped <- products %>% 
  group_by(name = three_four) %>% 
  do(categories = .$product_level) %>%
  list_parse()


#highchart() %>%
 # hc_add_series(data = products, type = "bar",
  #              hcaes(y = count, 
   #                   group = product_level),
    #            showInLegend = TRUE) %>%
    #hc_xAxis(categories = categories_grouped) %>%
  #hc_add_theme(hc_theme_economist())
pt <- ggplot(products, aes(factor(product_level), count, fill = three_four)) + 
  geom_bar(stat="identity", position = "dodge") + 
  scale_fill_brewer(palette = "Set1") + coord_flip() 

ggplotly(pt)
```

View3
=======================================================================
